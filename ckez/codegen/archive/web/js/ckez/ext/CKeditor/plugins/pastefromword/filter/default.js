(function(){function f(p){for(var p=p.toUpperCase(),o=e.length,t=0,s=0;s<o;++s){for(var r=e[s],q=r[1].length;p.substr(0,q)==r[1];p=p.substr(q)){t+=r[0]}}return t}function c(p){for(var p=p.toUpperCase(),o=b.length,r=1,q=1;0<p.length;q*=o){r+=b.indexOf(p.charAt(p.length-1))*q,p=p.substr(0,p.length-1)}return r}var a=CKEDITOR.htmlParser.fragment.prototype,k=CKEDITOR.htmlParser.element.prototype;a.onlyChild=k.onlyChild=function(){var o=this.children;return 1==o.length&&o[0]||null};k.removeAnyChildWithName=function(p){for(var o=this.children,s=[],r,q=0;q<o.length;q++){r=o[q],r.name&&(r.name==p&&(s.push(r),o.splice(q--,1)),s=s.concat(r.removeAnyChildWithName(p)))}return s};k.getAncestor=function(p){for(var o=this.parent;o&&(!o.name||!o.name.match(p));){o=o.parent}return o};a.firstChild=k.firstChild=function(p){for(var o,q=0;q<this.children.length;q++){if(o=this.children[q],p(o)||o.name&&(o=o.firstChild(p))){return o}}return null};k.addStyle=function(p,o,s){var r="";if("string"==typeof o){r+=p+":"+o+";"}else{if("object"==typeof p){for(var q in p){p.hasOwnProperty(q)&&(r+=q+":"+p[q]+";")}}else{r+=p}s=o}this.attributes||(this.attributes={});p=this.attributes.style||"";p=(s?[r,p]:[p,r]).join(";");this.attributes.style=p.replace(/^;|;(?=;)/,"")};k.getStyle=function(p){var o=this.attributes.style;if(o){return o=CKEDITOR.tools.parseCssText(o,1),o[p]}};CKEDITOR.dtd.parentOf=function(p){var o={},q;for(q in this){-1==q.indexOf("$")&&this[q][p]&&(o[q]=1)}return o};var j=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,n=/^(?:\b0[^\s]*\s*){1,4}$/,g={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},e=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0,d=null,h,m=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(p,o){var q=new CKEDITOR.htmlParser.element("cke:listbullet");q.attributes={"cke:listsymbol":p[0]};q.add(new CKEDITOR.htmlParser.text(o));return q},isListBulletIndicator:function(o){if(/mso-list\s*:\s*Ignore/i.test(o.attributes&&o.attributes.style)){return !0}},isContainingOnlySpaces:function(p){var o;return(o=p.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(o.value)},resolveList:function(p){var o=p.attributes,q;if((q=p.removeAnyChildWithName("cke:listbullet"))&&q.length&&(q=q[0])){return p.name="cke:li",o.style&&(o.style=m.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(r){r=r.split(" ");r=CKEDITOR.tools.convertToPx(r[3]||r[1]||r[0]);!i&&(null!==d&&r>d)&&(i=r-d);d=r;o["cke:indent"]=i&&Math.ceil(r/i)+1||1}],[/^mso-list$/,null,function(r){var r=r.split(" "),s=Number(r[0].match(/\d+/)),r=Number(r[1].match(/\d+/));1==r&&(s!==h&&(o["cke:reset"]=1),h=s);o["cke:indent"]=r}]])(o.style,p)||""),o["cke:indent"]||(d=0,o["cke:indent"]=1),CKEDITOR.tools.extend(o,q.attributes),!0}h=d=i=null;return !1},getStyleComponents:function(){var o=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(o);return function(p,s,r){o.setStyle(p,s);for(var p={},s=r.length,q=0;q<s;q++){p[r[q]]=o.getStyle(r[q])}return p}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(x,w){var w="number"==typeof w?w:1,v=x.attributes,u;switch(v.type){case"a":u="lower-alpha";break;case"1":u="decimal"}for(var t=x.children,s,q=0;q<t.length;q++){if(s=t[q],s.name in CKEDITOR.dtd.$listItem){var r=s.attributes,p=s.children,o=p[p.length-1];o.name in CKEDITOR.dtd.$list&&(x.add(o,q+1),--p.length||t.splice(q--,1));s.name="cke:li";v.start&&!q&&(r.value=v.start);m.filters.stylesFilter([["tab-stops",null,function(y){(y=y.split(" ")[1].match(j))&&(d=CKEDITOR.tools.convertToPx(y[0]))}],1==w?["mso-list",null,function(y){y=y.split(" ");y=Number(y[0].match(/\d+/));y!==h&&(r["cke:reset"]=1);h=y}]:null])(r.style);r["cke:indent"]=w;r["cke:listtype"]=x.name;r["cke:list-style-type"]=u}else{if(s.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[s,w+1]);t=t.slice(0,q).concat(s.children).concat(t.slice(q+1));x.children=[];s=0;for(p=t.length;s<p;s++){x.add(t[s])}}}}delete x.name;v["cke:list"]=1},assembleList:function(J){for(var I=J.children,H,G,F,E,C,D,J=[],B,x,A,y,z,u,v=0;v<I.length;v++){if(H=I[v],"cke:li"==H.name){if(H.name="li",G=H.attributes,A=(A=G["cke:listsymbol"])&&A.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),y=z=u=null,G["cke:ignored"]){I.splice(v--,1)}else{G["cke:reset"]&&(D=E=C=null);F=Number(G["cke:indent"]);F!=E&&(x=B=null);if(A){if(x&&g[x][B].test(A[1])){y=x,z=B}else{for(var q in g){for(var o in g[q]){if(g[q][o].test(A[1])){if("ol"==q&&/alpha|roman/.test(o)){if(B=/roman/.test(o)?f(A[1]):c(A[1]),!u||B<u){u=B,y=q,z=o}}else{y=q;z=o;break}}}}}!y&&(y=A[2]?"ol":"ul")}else{y=G["cke:listtype"]||"ol",z=G["cke:list-style-type"]}x=y;B=z||("ol"==y?"decimal":"disc");z&&z!=("ol"==y?"decimal":"disc")&&H.addStyle("list-style-type",z);if("ol"==y&&A){switch(z){case"decimal":u=Number(A[1]);break;case"lower-roman":case"upper-roman":u=f(A[1]);break;case"lower-alpha":case"upper-alpha":u=c(A[1])}H.attributes.value=u}if(D){if(F>E){J.push(D=new CKEDITOR.htmlParser.element(y)),D.add(H),C.add(D)}else{if(F<E){E-=F;for(var w;E--&&(w=D.parent);){D=w.parent}}D.add(H)}I.splice(v--,1)}else{J.push(D=new CKEDITOR.htmlParser.element(y)),D.add(H),I[v]=D}C=H;E=F}}else{D&&(D=E=C=null)}}for(v=0;v<J.length;v++){if(D=J[v],q=D.children,B=B=void 0,o=D.children.length,w=B=void 0,I=/list-style-type:(.*?)(?:;|$)/,E=CKEDITOR.plugins.pastefromword.filters.stylesFilter,B=D.attributes,!I.exec(B.style)){for(C=0;C<o;C++){if(B=q[C],B.attributes.value&&Number(B.attributes.value)==C+1&&delete B.attributes.value,B=I.exec(B.attributes.style)){if(B[1]==w||!w){w=B[1]}else{w=null;break}}}if(w){for(C=0;C<o;C++){B=q[C].attributes,B.style&&(B.style=E([["list-style-type"]])(B.style)||"")}D.addStyle("list-style-type",w)}}}h=d=i=null},falsyFilter:function(){return !1},stylesFilter:function(p,o){return function(t,s){var r=[];(t||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(A,y,z){y=y.toLowerCase();"font-family"==y&&(z=z.replace(/["']/g,""));for(var u,x,v,w=0;w<p.length;w++){if(p[w]&&(A=p[w][0],u=p[w][1],x=p[w][2],v=p[w][3],y.match(A)&&(!u||z.match(u)))){y=v||y;o&&(x=x||z);"function"==typeof x&&(x=x(z,s,y));x&&x.push&&(y=x[0],x=x[1]);"string"==typeof x&&r.push([y,x]);return}}!o&&r.push([y,z])});for(var q=0;q<r.length;q++){r[q]=r[q].join(":")}return r.length?r.join(";")+";":!1}},elementMigrateFilter:function(p,o){return p?function(r){var q=o?(new CKEDITOR.style(p,o))._.definition:p;r.name=q.element;CKEDITOR.tools.extend(r.attributes,CKEDITOR.tools.clone(q.attributes));r.addStyle(CKEDITOR.style.getStyleText(q))}:function(){}},styleMigrateFilter:function(p,o){var q=this.elementMigrateFilter;return p?function(u,t){var s=new CKEDITOR.htmlParser.element(null),r={};r[o]=u;q(p,r)(s);s.children=t.children;t.children=[s]}:function(){}},bogusAttrFilter:function(p,o){if(-1==o.name.indexOf("cke:")){return !1}},applyStyleFilter:null},getRules:function(L){var K=CKEDITOR.dtd,J=CKEDITOR.tools.extend({},K.$block,K.$listItem,K.$tableContent),I=L.config,H=this.filters,L=H.falsyFilter,G=H.stylesFilter,E=H.elementMigrateFilter,F=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),D=this.utils.createListBulletMarker,z=H.flattenList,C=H.assembleList,A=this.utils.isListBulletIndicator,B=this.utils.isContainingOnlySpaces,v=this.utils.resolveList,w=function(o){o=CKEDITOR.tools.convertToPx(o);return isNaN(o)?o:o+"px"},u=this.utils.getStyleComponents,q=this.utils.listDtdParents,y=!1!==I.pasteFromWordRemoveFontStyles,x=!1!==I.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(o){o.filterChildren();C(o)},elements:{"^":function(p){var o;CKEDITOR.env.gecko&&(o=H.applyStyleFilter)&&o(p)},$:function(o){var p=o.name||"",r=o.attributes;p in J&&r.style&&(r.style=G([[/^(:?width|height)$/,null,w]])(r.style)||"");if(p.match(/h\d/)){o.filterChildren();if(v(o)){return}E(I["format_"+p])(o)}else{if(p in K.$inline){o.filterChildren(),B(o)&&delete o.name}else{if(-1!=p.indexOf(":")&&-1==p.indexOf("cke")){o.filterChildren();if("v:imagedata"==p){if(p=o.attributes["o:href"]){o.attributes.src=p}o.name="img";return}delete o.name}}}p in q&&(o.filterChildren(),C(o))},style:function(p){if(CKEDITOR.env.gecko){var p=(p=p.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&p[1],o={};p&&(p.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(r,M,t){for(var M=M.split(","),r=M.length,s=0;s<r;s++){CKEDITOR.tools.trim(M[s]).replace(/^(\w+)(\.[\w-]+)?$/g,function(N,P,O){P=P||"*";O=O.substring(1,O.length);O.match(/MsoNormal/)||(o[P]||(o[P]={}),O?o[P][O]=t:o[P]=t)})}}),H.applyStyleFilter=function(r){var t=o["*"]?"*":r.name,s=r.attributes&&r.attributes["class"];t in o&&(t=o[t],"object"==typeof t&&(t=t[s]),t&&r.addStyle(t,!0))})}return !1},p:function(p){if(/MsoListParagraph/i.exec(p.attributes["class"])||p.getStyle("mso-list")){var o=p.firstChild(function(r){return r.type==CKEDITOR.NODE_TEXT&&!B(r.parent)});(o=o&&o.parent)&&o.addStyle("mso-list","Ignore")}p.filterChildren();v(p)||(I.enterMode==CKEDITOR.ENTER_BR?(delete p.name,p.add(new CKEDITOR.htmlParser.element("br"))):E(I["format_"+(I.enterMode==CKEDITOR.ENTER_P?"p":"div")])(p))},div:function(p){var o=p.onlyChild();if(o&&"table"==o.name){var r=p.attributes;o.attributes=CKEDITOR.tools.extend(o.attributes,r);r.style&&o.addStyle(r.style);o=new CKEDITOR.htmlParser.element("div");o.addStyle("clear","both");p.add(o);delete p.name}},td:function(o){o.getAncestor("thead")&&(o.name="th")},ol:z,ul:z,dl:z,font:function(p){if(A(p.parent)){delete p.name}else{p.filterChildren();var o=p.attributes,s=o.style,r=p.parent;"font"==r.name?(CKEDITOR.tools.extend(r.attributes,p.attributes),s&&r.addStyle(s),delete p.name):(s=s||"",o.color&&("#000000"!=o.color&&(s+="color:"+o.color+";"),delete o.color),o.face&&(s+="font-family:"+o.face+";",delete o.face),o.size&&(s+="font-size:"+(3<o.size?"large":3>o.size?"small":"medium")+";",delete o.size),p.name="span",p.addStyle(s))}},span:function(p){if(A(p.parent)){return !1}p.filterChildren();if(B(p)){return delete p.name,null}if(A(p)){var o=p.firstChild(function(s){return s.value||"img"==s.name}),r=(o=o&&(o.value||"l."))&&o.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(r){return o=D(r,o),(p=p.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(p.attributes.style)&&(o.attributes["cke:ignored"]=1),o}}if(r=(o=p.attributes)&&o.style){o.style=G([["line-height"],[/^font-family$/,null,!y?F(I.font_style,"family"):null],[/^font-size$/,null,!y?F(I.fontSize_style,"size"):null],[/^color$/,null,!y?F(I.colorButton_foreStyle,"color"):null],[/^background-color$/,null,!y?F(I.colorButton_backStyle,"color"):null]])(r,p)||""}o.style||delete o.style;CKEDITOR.tools.isEmpty(o)&&delete p.name;return null},b:E(I.coreStyles_bold),i:E(I.coreStyles_italic),u:E(I.coreStyles_underline),s:E(I.coreStyles_strike),sup:E(I.coreStyles_superscript),sub:E(I.coreStyles_subscript),a:function(p){var o=p.attributes;o&&!o.href&&o.name?delete p.name:CKEDITOR.env.webkit&&(o.href&&o.href.match(/file:\/\/\/[\S]+#/i))&&(o.href=o.href.replace(/file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(o){o.getAncestor(/h\d/)&&!I.pasteFromWordNumberedHeadingToList&&delete o.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:G(x?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(p,o,r){if(o.name in {p:1,div:1}){o="ltr"==I.contentsLangDirection?"margin-left":"margin-right";if("margin"==r){p=u(r,p,[o])[o]}else{if(r!=o){return null}}if(p&&!n.test(p)){return[o,p]}}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(p,o){if("img"==o.name){return p}}],[/^width|height$/,null,function(p,o){if(o.name in {table:1,td:1,th:1,img:1}){return p}}]]:[[/^mso-/],[/-color$/,null,function(o){if("transparent"==o){return !1}if(CKEDITOR.env.gecko){return o.replace(/-moz-use-text-color/g,"transparent")}}],[/^margin$/,n],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],y?[/font-?/]:null],x),width:function(o,p){if(p.name in K.$tableContent){return !1}},border:function(o,p){if(p.name in K.$tableContent){return !1}},"class":L,bgcolor:L,valign:x?L:function(p,o){o.addStyle("vertical-align",p);return !1}},comment:!CKEDITOR.env.ie?function(p,o){var s=p.match(/<img.*?>/),r=p.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return r?(r=(s=r[1]||s&&"l.")&&s.match(/>(?:[(]?)([^\s]+?)([.)]?)</),D(r,s)):CKEDITOR.env.gecko&&s?(s=CKEDITOR.htmlParser.fragment.fromHtml(s[0]).children[0],(r=(r=(r=o.previous)&&r.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&r[1])&&(s.attributes.src=r),s):!1}:L}}},l=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};l.prototype={toHtml:function(p){var p=CKEDITOR.htmlParser.fragment.fromHtml(p),o=new CKEDITOR.htmlParser.basicWriter;p.writeHtml(o,this.dataFilter);return o.getHtml(!0)}};CKEDITOR.cleanWord=function(p,o){CKEDITOR.env.gecko&&(p=p.replace(/(<\!--\[if[^<]*?\])--\>([\S\s]*?)<\!--(\[endif\]--\>)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(p=p.replace(/(class="MsoListParagraph[^>]+><\!--\[if !supportLists\]--\>)([^<]+<span[^<]+<\/span>)(<\!--\[endif\]--\>)/gi,"$1<span>$2</span>$3"));var s=new l,r=s.dataFilter;r.addRules(CKEDITOR.plugins.pastefromword.getRules(o));o.fire("beforeCleanWord",{filter:r});try{p=s.toHtml(p)}catch(q){alert(o.lang.pastefromword.error)}p=p.replace(/cke:.*?".*?"/g,"");p=p.replace(/style=""/g,"");return p=p.replace(/<span>/g,"")}})();